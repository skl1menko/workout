# üéâ Backend —Å–µ—Ä–≤–µ—Ä —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. Backend —Å–µ—Ä–≤–µ—Ä (Node.js + Express + TypeScript)
- ‚úÖ –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π REST API
- ‚úÖ SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ TypeScript –¥–ª—è —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
- ‚úÖ CORS, Helmet, Morgan middleware
- ‚úÖ Graceful shutdown

### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite)
–°–æ–∑–¥–∞–Ω—ã —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è:
- ‚úÖ **steps** - —à–∞–≥–∏ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –¥–∏—Å—Ç–∞–Ω—Ü–∏—è, –∫–∞–ª–æ—Ä–∏–∏)
- ‚úÖ **heart_rate** - –ø—É–ª—å—Å (BPM, timestamp)
- ‚úÖ **sleep** - —Å–æ–Ω (–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∫–∞—á–µ—Å—Ç–≤–æ)
- ‚úÖ **calories** - –∫–∞–ª–æ—Ä–∏–∏ (–∞–∫—Ç–∏–≤–Ω—ã–µ, –ø–∞—Å—Å–∏–≤–Ω—ã–µ, –æ–±—â–∏–µ)
- ‚úÖ **workouts** - —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (—Ç–∏–ø, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∫–∞–ª–æ—Ä–∏–∏)
- ‚úÖ **distance** - –¥–∏—Å—Ç–∞–Ω—Ü–∏—è

### 3. API Endpoints
```
GET  /api/health                    - health check
GET  /api/steps                     - –ø–æ–ª—É—á–∏—Ç—å —à–∞–≥–∏
POST /api/steps                     - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —à–∞–≥–∏
GET  /api/heart-rate                - –ø–æ–ª—É—á–∏—Ç—å –ø—É–ª—å—Å
POST /api/heart-rate                - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—É–ª—å—Å
GET  /api/sleep                     - –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Å–Ω–µ
POST /api/sleep                     - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Å–Ω–µ
GET  /api/calories                  - –ø–æ–ª—É—á–∏—Ç—å –∫–∞–ª–æ—Ä–∏–∏
POST /api/calories                  - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–ª–æ—Ä–∏–∏
GET  /api/workouts                  - –ø–æ–ª—É—á–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
POST /api/workouts                  - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É
GET  /api/summary?date=YYYY-MM-DD   - —Å–≤–æ–¥–∫–∞ –∑–∞ –¥–µ–Ω—å
```

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å React Native
- ‚úÖ `backend-api.service.ts` - —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API
- ‚úÖ `use-backend-sync.ts` - —Ö—É–∫ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚úÖ `config.ts` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è URL
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç
- ‚úÖ –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ –∑–∞–ø—Ä–æ—Å—É

### 5. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ `backend/README.md` - –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è backend
- ‚úÖ `backend/API_EXAMPLES.md` - –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API
- ‚úÖ `BACKEND_INTEGRATION.md` - –≥–∞–π–¥ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚úÖ `test-api.sh` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ó–∞–ø—É—Å–∫ backend —Å–µ—Ä–≤–µ—Ä–∞
```bash
cd backend
npm run dev
```
–°–µ—Ä–≤–µ—Ä: http://localhost:3001

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ React Native
```typescript
import { useBackendSync } from './src/hooks';

function HealthScreen() {
  const { healthData } = useHealthData();
  const { syncToBackend } = useBackendSync(healthData, true);
  
  return (
    <Button title="–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å" onPress={syncToBackend} />
  );
}
```

### –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API
```typescript
import { backendAPI } from './src/services';

// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
await backendAPI.saveSteps({
  date: '2024-01-15',
  count: 12000,
  distance: 8.5,
  calories: 420
});

// –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
const steps = await backendAPI.getSteps('2024-01-01', '2024-01-31');
const summary = await backendAPI.getDailySummary('2024-01-15');
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
curl http://localhost:3001/api/health

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
curl -X POST http://localhost:3001/api/steps \
  -H "Content-Type: application/json" \
  -d '{"date":"2024-01-15","count":12000,"distance":8.5,"calories":420}'

# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
curl http://localhost:3001/api/steps

# –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –≤—Å–µ—Ö endpoints
./backend/test-api.sh
```

## üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
sqlite3 backend/data/health.db ".tables"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö
sqlite3 backend/data/health.db "SELECT * FROM steps;"
sqlite3 backend/data/health.db "SELECT * FROM workouts ORDER BY date DESC;"

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
sqlite3 backend/data/health.db "SELECT COUNT(*) FROM steps;"
```

## üåê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤/–ø—Ä–æ–µ–∫—Ç–æ–≤

Backend –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ HTTP, –ø–æ—ç—Ç–æ–º—É –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –∏–∑:
- ‚úÖ –î—Ä—É–≥–∏—Ö –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚úÖ Web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚úÖ Desktop –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- ‚úÖ IoT —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ –õ—é–±—ã—Ö HTTP –∫–ª–∏–µ–Ω—Ç–æ–≤

–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `http://localhost:3001/api`

### –ü—Ä–∏–º–µ—Ä –Ω–∞ Python
```python
import requests

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —à–∞–≥–∏
response = requests.post('http://localhost:3001/api/steps', json={
    'date': '2024-01-15',
    'count': 12000,
    'distance': 8.5,
    'calories': 420
})
print(response.json())

# –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
response = requests.get('http://localhost:3001/api/steps')
print(response.json())
```

### –ü—Ä–∏–º–µ—Ä –Ω–∞ JavaScript (Web)
```javascript
// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
fetch('http://localhost:3001/api/steps', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    date: '2024-01-15',
    count: 12000,
    distance: 8.5,
    calories: 420
  })
})
.then(res => res.json())
.then(data => console.log(data));
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

1. –ù–∞–π–¥–∏—Ç–µ IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞:
```bash
# macOS
ipconfig getifaddr en0

# –†–µ–∑—É–ª—å—Ç–∞—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä: 192.168.1.100
```

2. –û–±–Ω–æ–≤–∏—Ç–µ `src/constants/config.ts`:
```typescript
export const API_BASE_URL = 'http://192.168.1.100:3001/api';
```

3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ —Ç–æ–π –∂–µ Wi-Fi —Å–µ—Ç–∏

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
workout/
‚îú‚îÄ‚îÄ backend/                          # Backend —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts                 # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.ts              # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers.ts           # API –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routes.ts                # API –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health.db                # SQLite –ë–î (56KB)
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ   ‚îú‚îÄ‚îÄ .env                         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ README.md                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ API_EXAMPLES.md              # –ü—Ä–∏–º–µ—Ä—ã API
‚îÇ   ‚îî‚îÄ‚îÄ test-api.sh                  # –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ backend-api.service.ts   # API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ use-backend-sync.ts      # –•—É–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ constants/
‚îÇ       ‚îî‚îÄ‚îÄ config.ts                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è URL
‚îÇ
‚îî‚îÄ‚îÄ BACKEND_INTEGRATION.md            # –ì–∞–π–¥ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ backend**: `cd backend && npm run dev`
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ API**: `./backend/test-api.sh`
3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `useBackendSync`
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–ª–∏ —Ä—É—á–Ω–∞—è
5. **–î–µ–ø–ª–æ–π** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): Heroku, AWS, DigitalOcean

## üîê Production –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

–î–ª—è production –¥–æ–±–∞–≤—å—Ç–µ:
- [ ] JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- [ ] Rate limiting
- [ ] HTTPS/SSL
- [ ] Input validation & sanitization
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] Backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [ ] Environment variables
- [ ] Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—é

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# Backend
cd backend
npm run dev          # –ó–∞–ø—É—Å–∫ dev —Å–µ—Ä–≤–µ—Ä–∞
npm run build        # –°–±–æ—Ä–∫–∞ –¥–ª—è production
npm start            # –ó–∞–ø—É—Å–∫ production

# Database
sqlite3 backend/data/health.db        # –û—Ç–∫—Ä—ã—Ç—å –ë–î
.tables                               # –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
SELECT * FROM steps;                  # –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö
.quit                                 # –í—ã—Ö–æ–¥

# Testing
curl http://localhost:3001/api/health # Health check
./backend/test-api.sh                 # –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω: `curl http://localhost:3001/api/health`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ backend –≤ –∫–æ–Ω—Å–æ–ª–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤ `src/constants/config.ts`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ—Ä—Ç 3001 —Å–≤–æ–±–æ–¥–µ–Ω

## üéâ –ì–æ—Ç–æ–≤–æ!

Backend —Å–µ—Ä–≤–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

- ‚úÖ REST API —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∞
- ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ:
1. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ React Native –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –∏–∑ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
3. –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
5. –î–µ–ø–ª–æ–∏—Ç—å –Ω–∞ production —Å–µ—Ä–≤–µ—Ä

**–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞:** http://localhost:3001 üöÄ
